@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <button id="center">Center on markers</button>
@(Html.Kendo().Map()
      .Name("map")
      .Center(30.2681, -97.7448)
      .Zoom(3)
      .Layers(layers =>
               {

                   layers.Add()
                .Type(MapLayerType.Tile)
                .UrlTemplate("http://#= subdomain #.tile.openstreetmap.org/#= zoom #/#= x #/#= y #.png")
                .Subdomains("a", "b", "c")
                .Attribution("&copy; <a href='http://osm.org/copyright'>OpenStreetMap contributors</a>");
                   layers.Add()
                      .Style(style => style.Fill(fill => fill.Opacity(0.0)))
                      .Style(style => style.Stroke(stroke => stroke.Width(5)))
                      .Type(MapLayerType.Shape)
                      .TitleField("name")
                      .DataSource(dataSource => dataSource
                          .GeoJson()
                          .Read(read => read.Url(Url.Content("~/Content/map.json")))
                      );
               })
            .Events(events => events
           .ShapeCreated("onShapeCreated")
           .ShapeMouseEnter("onShapeMouseEnter")
           .ShapeMouseLeave("onShapeMouseLeave")
        )
)

<script src="@Url.Content("~/Content/dataviz/map/js/chroma.min.js")"></script>

<script>
    var scale = chroma
           .scale(["black", "black"])
           .domain([1, 1000]);

    function onShapeCreated(e) {
        var shape = e.shape;
        // Calculate shape bounding box
        var bbox = e.shape.bbox();
        var center = bbox.center();

        // Create the label
        var labelText = e.shape.dataItem.properties.name;
        var label = new kendo.drawing.Text(labelText);
        var labelCenter = label.bbox().center();

        // Position the label
        label.position([
          center.x - labelCenter.x,
          center.y - labelCenter.y
        ]);

        // Render the label on the layer surface
        e.layer.surface.draw(label);
    }

    function onShapeMouseEnter(e) {
        e.shape.options.set("fill.opacity", 1);
    }

    function onShapeMouseLeave(e) {
        e.shape.options.set("fill.opacity", 0.0);
    }
</script>
 )
</div>